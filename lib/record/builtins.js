/*******************************************************************************
 * Copyright (c) 2013 Max Schaefer.
 * All rights reserved. This program and the accompanying materials
 * are made available under the terms of the Eclipse Public License v1.0
 * which accompanies this distribution, and is available at
 * http://www.eclipse.org/legal/epl-v10.html
 *
 * Contributors:
 *     Max Schaefer - initial API and implementation
 *******************************************************************************/
 
/*global require exports*/

var util = require('../util'),
    Tag = require('./Tag').Tag;

/** A (slightly random) sampling of built-in (i.e., standard library and DOM) objects
  * that our analysis knows about. Generated by reflectively crawling the object graph
  * of Chrome after loading an empty page. */
var builtins = [
    "eval",
    "parseInt",
    "parseFloat",
    "isNaN",
    "isFinite",
    "decodeURI",
    "decodeURIComponent",
    "encodeURI",
    "encodeURIComponent",
    "Object.defineProperties",
    "Object.isSealed",
    "Object.defineProperty",
    "Object.freeze",
    "Object.preventExtensions",
    "Object.keys",
    "Object.getOwnPropertyNames",
    "Object.getPrototypeOf",
    "Object.is",
    "Object.isFrozen",
    "Object.prototype.toLocaleString",
    "Object.prototype.valueOf",
    "Object.prototype.toString",
    "Object.prototype.hasOwnProperty",
    "Object.prototype.isPrototypeOf",
    "Object.prototype.propertyIsEnumerable",
    "Object.getOwnPropertyDescriptor",
    "Object.isExtensible",
    "Object.seal",
    "Object.create",
    "Function.prototype.toString",
    "Function.prototype.apply",
    "Function.prototype.bind",
    "Function.prototype.call",
    "Array.isArray",
    "Array.prototype.some",
    "Array.prototype.indexOf",
    "Array.prototype.lastIndexOf",
    "Array.prototype.push",
    "Array.prototype.sort",
    "Array.prototype.concat",
    "Array.prototype.toLocaleString",
    "Array.prototype.map",
    "Array.prototype.forEach",
    "Array.prototype.splice",
    "Array.prototype.reverse",
    "Array.prototype.toString",
    "Array.prototype.join",
    "Array.prototype.every",
    "Array.prototype.slice",
    "Array.prototype.reduce",
    "Array.prototype.pop",
    "Array.prototype.unshift",
    "Array.prototype.shift",
    "Array.prototype.reduceRight",
    "Array.prototype.filter",
    "String.prototype.strike",
    "String.prototype.fontcolor",
    "String.prototype.blink",
    "String.prototype.trimLeft",
    "String.prototype.fixed",
    "String.prototype.split",
    "String.prototype.indexOf",
    "String.prototype.lastIndexOf",
    "String.prototype.charAt",
    "String.prototype.small",
    "String.prototype.toLocaleUpperCase",
    "String.prototype.concat",
    "String.prototype.bold",
    "String.prototype.substring",
    "String.prototype.toLowerCase",
    "String.prototype.valueOf",
    "String.prototype.big",
    "String.prototype.fontsize",
    "String.prototype.italics",
    "String.prototype.search",
    "String.prototype.sub",
    "String.prototype.toString",
    "String.prototype.toUpperCase",
    "String.prototype.link",
    "String.prototype.slice",
    "String.prototype.replace",
    "String.prototype.anchor",
    "String.prototype.substr",
    "String.prototype.localeCompare",
    "String.prototype.sup",
    "String.prototype.charCodeAt",
    "String.prototype.toLocaleLowerCase",
    "String.prototype.trim",
    "String.prototype.match",
    "String.prototype.trimRight",
    "String.fromCharCode",
    "Boolean.prototype.valueOf",
    "Boolean.prototype.toString",
    "Number.isFinite",
    "Number.isNaN",
    "Number.prototype.toFixed",
    "Number.prototype.toExponential",
    "Number.prototype.toLocaleString",
    "Number.prototype.valueOf",
    "Number.prototype.toString",
    "Number.prototype.toPrecision",
    "Date.now",
    "Date.UTC",
    "Date.parse",
    "Date.prototype.getMinutes",
    "Date.prototype.setUTCMilliseconds",
    "Date.prototype.setUTCDate",
    "Date.prototype.getMonth",
    "Date.prototype.toGMTString",
    "Date.prototype.setUTCMinutes",
    "Date.prototype.setUTCMonth",
    "Date.prototype.getUTCMinutes",
    "Date.prototype.setFullYear",
    "Date.prototype.toDateString",
    "Date.prototype.getUTCDay",
    "Date.prototype.getTimezoneOffset",
    "Date.prototype.setUTCHours",
    "Date.prototype.getUTCDate",
    "Date.prototype.getMilliseconds",
    "Date.prototype.getUTCMilliseconds",
    "Date.prototype.getDay",
    "Date.prototype.toJSON",
    "Date.prototype.getUTCFullYear",
    "Date.prototype.toLocaleString",
    "Date.prototype.setUTCSeconds",
    "Date.prototype.setMonth",
    "Date.prototype.getDate",
    "Date.prototype.valueOf",
    "Date.prototype.setMinutes",
    "Date.prototype.getTime",
    "Date.prototype.setSeconds",
    "Date.prototype.toUTCString",
    "Date.prototype.setTime",
    "Date.prototype.toString",
    "Date.prototype.setYear",
    "Date.prototype.setHours",
    "Date.prototype.toTimeString",
    "Date.prototype.getUTCSeconds",
    "Date.prototype.toLocaleTimeString",
    "Date.prototype.setMilliseconds",
    "Date.prototype.getYear",
    "Date.prototype.getFullYear",
    "Date.prototype.getUTCMonth",
    "Date.prototype.getHours",
    "Date.prototype.toLocaleDateString",
    "Date.prototype.getUTCHours",
    "Date.prototype.toISOString",
    "Date.prototype.getSeconds",
    "Date.prototype.setUTCFullYear",
    "Date.prototype.setDate",
    "RegExp.prototype.compile",
    "RegExp.prototype.exec",
    "RegExp.prototype.toString",
    "RegExp.prototype.test",
    "Error.captureStackTrace",
    "Error.prototype.toString",
    "EvalError",
    "RangeError",
    "ReferenceError",
    "SyntaxError",
    "TypeError",
    "URIError",
    "Math.sqrt",
    "Math.abs",
    "Math.max",
    "Math.tan",
    "Math.round",
    "Math.random",
    "Math.exp",
    "Math.log",
    "Math.ceil",
    "Math.sin",
    "Math.atan",
    "Math.cos",
    "Math.asin",
    "Math.pow",
    "Math.atan2",
    "Math.acos",
    "Math.min",
    "Math.floor",
    "JSON.parse",
    "JSON.stringify",
    "Attr.toString",
    "Audio.prototype.canPlayType",
    "Audio.prototype.load",
    "Audio.prototype.pause",
    "Audio.prototype.play",
    "DOMStringList.toString",
    "DOMStringList.prototype.contains",
    "DOMStringList.prototype.item",
    "CanvasGradient.toString",
    "CanvasGradient.prototype.addColorStop",
    "CanvasPattern.toString",
    "CanvasRenderingContext2D.toString",
    "CanvasRenderingContext2D.prototype.fillRect",
    "CanvasRenderingContext2D.prototype.setLineWidth",
    "CanvasRenderingContext2D.prototype.save",
    "CanvasRenderingContext2D.prototype.strokeRect",
    "CanvasRenderingContext2D.prototype.createRadialGradient",
    "CanvasRenderingContext2D.prototype.stroke",
    "CanvasRenderingContext2D.prototype.setLineCap",
    "CanvasRenderingContext2D.prototype.isPointInPath",
    "CanvasRenderingContext2D.prototype.lineTo",
    "CanvasRenderingContext2D.prototype.setMiterLimit",
    "CanvasRenderingContext2D.prototype.clip",
    "CanvasRenderingContext2D.prototype.arc",
    "CanvasRenderingContext2D.prototype.closePath",
    "CanvasRenderingContext2D.prototype.restore",
    "CanvasRenderingContext2D.prototype.getImageData",
    "CanvasRenderingContext2D.prototype.setTransform",
    "CanvasRenderingContext2D.prototype.setStrokeColor",
    "CanvasRenderingContext2D.prototype.clearRect",
    "CanvasRenderingContext2D.prototype.webkitPutImageDataHD",
    "CanvasRenderingContext2D.prototype.setFillColor",
    "CanvasRenderingContext2D.prototype.createLinearGradient",
    "CanvasRenderingContext2D.prototype.drawImage",
    "CanvasRenderingContext2D.prototype.bezierCurveTo",
    "CanvasRenderingContext2D.prototype.moveTo",
    "CanvasRenderingContext2D.prototype.fill",
    "CanvasRenderingContext2D.prototype.rect",
    "CanvasRenderingContext2D.prototype.webkitGetImageDataHD",
    "CanvasRenderingContext2D.prototype.fillText",
    "CanvasRenderingContext2D.prototype.putImageData",
    "CanvasRenderingContext2D.prototype.beginPath",
    "CanvasRenderingContext2D.prototype.rotate",
    "CanvasRenderingContext2D.prototype.measureText",
    "CanvasRenderingContext2D.prototype.scale",
    "CanvasRenderingContext2D.prototype.quadraticCurveTo",
    "CanvasRenderingContext2D.prototype.translate",
    "CanvasRenderingContext2D.prototype.setCompositeOperation",
    "CanvasRenderingContext2D.prototype.clearShadow",
    "CanvasRenderingContext2D.prototype.setShadow",
    "CanvasRenderingContext2D.prototype.setLineJoin",
    "CanvasRenderingContext2D.prototype.arcTo",
    "CanvasRenderingContext2D.prototype.strokeText",
    "CanvasRenderingContext2D.prototype.createPattern",
    "CanvasRenderingContext2D.prototype.drawImageFromRect",
    "CanvasRenderingContext2D.prototype.transform",
    "CanvasRenderingContext2D.prototype.setAlpha",
    "CanvasRenderingContext2D.prototype.createImageData",
    "CDATASection.toString",
    "CharacterData.toString",
    "CharacterData.prototype.replaceData",
    "CharacterData.prototype.insertData",
    "CharacterData.prototype.deleteData",
    "CharacterData.prototype.appendData",
    "CharacterData.prototype.substringData",
    "Comment.toString",
    "CSSRule.toString",
    "CSSStyleDeclaration.toString",
    "CSSStyleDeclaration.prototype.getPropertyCSSValue",
    "CSSStyleDeclaration.prototype.setProperty",
    "CSSStyleDeclaration.prototype.getPropertyPriority",
    "CSSStyleDeclaration.prototype.item",
    "CSSStyleDeclaration.prototype.isPropertyImplicit",
    "CSSStyleDeclaration.prototype.getPropertyValue",
    "CSSStyleDeclaration.prototype.getPropertyShorthand",
    "CSSStyleDeclaration.prototype.removeProperty",
    "CSSStyleSheet.toString",
    "CSSStyleSheet.prototype.deleteRule",
    "CSSStyleSheet.prototype.removeRule",
    "CSSStyleSheet.prototype.insertRule",
    "CSSStyleSheet.prototype.addRule",
    "Document.toString",
    "Document.prototype.createElementNS",
    "Document.prototype.queryCommandIndeterm",
    "Document.prototype.createProcessingInstruction",
    "Document.prototype.evaluate",
    "Document.prototype.createAttribute",
    "Document.prototype.adoptNode",
    "Document.prototype.getCSSCanvasContext",
    "Document.prototype.createTextNode",
    "Document.prototype.queryCommandState",
    "Document.prototype.importNode",
    "Document.prototype.getSelection",
    "Document.prototype.webkitCancelFullScreen",
    "Document.prototype.createElement",
    "Document.prototype.getElementsByName",
    "Document.prototype.createCDATASection",
    "Document.prototype.querySelectorAll",
    "Document.prototype.caretRangeFromPoint",
    "Document.prototype.queryCommandEnabled",
    "Document.prototype.createRange",
    "Document.prototype.createDocumentFragment",
    "Document.prototype.createNodeIterator",
    "Document.prototype.createEntityReference",
    "Document.prototype.createAttributeNS",
    "Document.prototype.getOverrideStyle",
    "Document.prototype.execCommand",
    "Document.prototype.createTreeWalker",
    "Document.prototype.getElementById",
    "Document.prototype.webkitGetFlowByName",
    "Document.prototype.getElementsByClassName",
    "Document.prototype.querySelector",
    "Document.prototype.createExpression",
    "Document.prototype.createComment",
    "Document.prototype.createEvent",
    "Document.prototype.elementFromPoint",
    "Document.prototype.getElementsByTagNameNS",
    "Document.prototype.createNSResolver",
    "Document.prototype.webkitExitFullscreen",
    "Document.prototype.queryCommandValue",
    "Document.prototype.getElementsByTagName",
    "Document.prototype.queryCommandSupported",
    "DocumentFragment.toString",
    "DocumentFragment.prototype.querySelectorAll",
    "DocumentFragment.prototype.querySelector",
    "DocumentType.toString",
    "DOMException.toString",
    "DOMException.prototype.toString",
    "DOMImplementation.toString",
    "DOMImplementation.prototype.createDocument",
    "DOMImplementation.prototype.createHTMLDocument",
    "DOMImplementation.prototype.createDocumentType",
    "DOMImplementation.prototype.hasFeature",
    "DOMImplementation.prototype.createCSSStyleSheet",
    "DOMParser.toString",
    "DOMParser.prototype.parseFromString",
    "Element.toString",
    "Element.prototype.setAttributeNode",
    "Element.prototype.scrollIntoView",
    "Element.prototype.webkitRequestFullScreen",
    "Element.prototype.getAttributeNode",
    "Element.prototype.focus",
    "Element.prototype.setAttributeNS",
    "Element.prototype.getAttribute",
    "Element.prototype.scrollIntoViewIfNeeded",
    "Element.prototype.hasAttributeNS",
    "Element.prototype.getClientRects",
    "Element.prototype.getAttributeNS",
    "Element.prototype.webkitMatchesSelector",
    "Element.prototype.setAttribute",
    "Element.prototype.removeAttributeNS",
    "Element.prototype.getBoundingClientRect",
    "Element.prototype.querySelectorAll",
    "Element.prototype.hasAttribute",
    "Element.prototype.setAttributeNodeNS",
    "Element.prototype.getElementsByClassName",
    "Element.prototype.getAttributeNodeNS",
    "Element.prototype.querySelector",
    "Element.prototype.webkitRequestFullscreen",
    "Element.prototype.removeAttribute",
    "Element.prototype.scrollByLines",
    "Element.prototype.blur",
    "Element.prototype.removeAttributeNode",
    "Element.prototype.getElementsByTagNameNS",
    "Element.prototype.scrollByPages",
    "Element.prototype.getElementsByTagName",
    "Event.toString",
    "Event.prototype.stopPropagation",
    "Event.prototype.initEvent",
    "Event.prototype.preventDefault",
    "Event.prototype.stopImmediatePropagation",
    "HTMLCollection.toString",
    "HTMLCollection.prototype.item",
    "HTMLCollection.prototype.namedItem",
    "HTMLElement.toString",
    "HTMLElement.prototype.click",
    "HTMLElement.prototype.insertAdjacentElement",
    "HTMLElement.prototype.insertAdjacentHTML",
    "HTMLElement.prototype.insertAdjacentText",
    "HTMLAnchorElement.toString",
    "HTMLAnchorElement.prototype.toString",
    "HTMLAppletElement.toString",
    "HTMLAudioElement.toString",
    "HTMLAreaElement.toString",
    "HTMLBaseElement.toString",
    "HTMLBaseFontElement.toString",
    "HTMLBodyElement.toString",
    "HTMLBRElement.toString",
    "HTMLButtonElement.toString",
    "HTMLButtonElement.prototype.setCustomValidity",
    "HTMLButtonElement.prototype.checkValidity",
    "HTMLCanvasElement.toString",
    "HTMLCanvasElement.prototype.toDataURL",
    "HTMLCanvasElement.prototype.getContext",
    "HTMLDirectoryElement.toString",
    "HTMLDivElement.toString",
    "HTMLDListElement.toString",
    "HTMLEmbedElement.toString",
    "HTMLEmbedElement.prototype.getSVGDocument",
    "HTMLFieldSetElement.toString",
    "HTMLFieldSetElement.prototype.setCustomValidity",
    "HTMLFieldSetElement.prototype.checkValidity",
    "HTMLFontElement.toString",
    "HTMLFormElement.toString",
    "HTMLFormElement.prototype.reset",
    "HTMLFormElement.prototype.submit",
    "HTMLFormElement.prototype.checkValidity",
    "HTMLFrameElement.toString",
    "HTMLFrameElement.prototype.getSVGDocument",
    "HTMLFrameSetElement.toString",
    "HTMLHeadElement.toString",
    "HTMLHeadingElement.toString",
    "HTMLHtmlElement.toString",
    "HTMLHRElement.toString",
    "HTMLIFrameElement.toString",
    "HTMLIFrameElement.prototype.getSVGDocument",
    "HTMLImageElement.toString",
    "HTMLInputElement.toString",
    "HTMLInputElement.prototype.stepDown",
    "HTMLInputElement.prototype.select",
    "HTMLInputElement.prototype.setCustomValidity",
    "HTMLInputElement.prototype.checkValidity",
    "HTMLInputElement.prototype.setSelectionRange",
    "HTMLInputElement.prototype.stepUp",
    "HTMLKeygenElement.toString",
    "HTMLKeygenElement.prototype.setCustomValidity",
    "HTMLKeygenElement.prototype.checkValidity",
    "HTMLLabelElement.toString",
    "HTMLLIElement.toString",
    "HTMLLinkElement.toString",
    "HTMLMapElement.toString",
    "HTMLMenuElement.toString",
    "HTMLMetaElement.toString",
    "HTMLModElement.toString",
    "HTMLObjectElement.toString",
    "HTMLObjectElement.prototype.setCustomValidity",
    "HTMLObjectElement.prototype.checkValidity",
    "HTMLObjectElement.prototype.getSVGDocument",
    "HTMLOListElement.toString",
    "HTMLOptGroupElement.toString",
    "HTMLOptionElement.toString",
    "HTMLOutputElement.toString",
    "HTMLOutputElement.prototype.setCustomValidity",
    "HTMLOutputElement.prototype.checkValidity",
    "HTMLParagraphElement.toString",
    "HTMLParamElement.toString",
    "HTMLPreElement.toString",
    "HTMLQuoteElement.toString",
    "HTMLScriptElement.toString",
    "HTMLSelectElement.toString",
    "HTMLSelectElement.prototype.setCustomValidity",
    "HTMLSelectElement.prototype.add",
    "HTMLSelectElement.prototype.item",
    "HTMLSelectElement.prototype.namedItem",
    "HTMLSelectElement.prototype.checkValidity",
    "HTMLSelectElement.prototype.remove",
    "HTMLSourceElement.toString",
    "HTMLSpanElement.toString",
    "HTMLStyleElement.toString",
    "HTMLTableElement.toString",
    "HTMLTableElement.prototype.deleteTFoot",
    "HTMLTableElement.prototype.deleteRow",
    "HTMLTableElement.prototype.createTHead",
    "HTMLTableElement.prototype.createTFoot",
    "HTMLTableElement.prototype.createTBody",
    "HTMLTableElement.prototype.deleteTHead",
    "HTMLTableElement.prototype.createCaption",
    "HTMLTableElement.prototype.insertRow",
    "HTMLTableElement.prototype.deleteCaption",
    "HTMLTableCaptionElement.toString",
    "HTMLTableColElement.toString",
    "HTMLTableRowElement.toString",
    "HTMLTableRowElement.prototype.insertCell",
    "HTMLTableRowElement.prototype.deleteCell",
    "HTMLTableSectionElement.toString",
    "HTMLTableSectionElement.prototype.deleteRow",
    "HTMLTableSectionElement.prototype.insertRow",
    "HTMLTextAreaElement.toString",
    "HTMLTextAreaElement.prototype.select",
    "HTMLTextAreaElement.prototype.setCustomValidity",
    "HTMLTextAreaElement.prototype.checkValidity",
    "HTMLTextAreaElement.prototype.setSelectionRange",
    "HTMLTitleElement.toString",
    "HTMLUListElement.toString",
    "HTMLUnknownElement.toString",
    "HTMLVideoElement.toString",
    "HTMLVideoElement.prototype.webkitEnterFullscreen",
    "HTMLVideoElement.prototype.webkitEnterFullScreen",
    "HTMLVideoElement.prototype.webkitExitFullScreen",
    "HTMLVideoElement.prototype.webkitExitFullscreen",
    "Image",
    "ImageData.toString",
    "MimeType.toString",
    "MouseEvent.toString",
    "MouseEvent.prototype.initMouseEvent",
    "Node.toString",
    "Node.prototype.insertBefore",
    "Node.prototype.addEventListener",
    "Node.prototype.compareDocumentPosition",
    "Node.prototype.contains",
    "Node.prototype.hasAttributes",
    "Node.prototype.isSupported",
    "Node.prototype.lookupNamespaceURI",
    "Node.prototype.lookupPrefix",
    "Node.prototype.isSameNode",
    "Node.prototype.normalize",
    "Node.prototype.removeChild",
    "Node.prototype.cloneNode",
    "Node.prototype.hasChildNodes",
    "Node.prototype.dispatchEvent",
    "Node.prototype.removeEventListener",
    "Node.prototype.isDefaultNamespace",
    "Node.prototype.replaceChild",
    "Node.prototype.isEqualNode",
    "Node.prototype.appendChild",
    "NodeList.toString",
    "NodeList.prototype.item",
    "Option",
    "Plugin",
    "Plugin.toString",
    "Plugin.prototype.item",
    "Plugin.prototype.namedItem",
    "ProcessingInstruction",
    "ProcessingInstruction.toString",
    "Range.toString",
    "Range.prototype.setEnd",
    "Range.prototype.compareNode",
    "Range.prototype.intersectsNode",
    "Range.prototype.isPointInRange",
    "Range.prototype.getClientRects",
    "Range.prototype.setStartAfter",
    "Range.prototype.insertNode",
    "Range.prototype.extractContents",
    "Range.prototype.expand",
    "Range.prototype.deleteContents",
    "Range.prototype.getBoundingClientRect",
    "Range.prototype.setStartBefore",
    "Range.prototype.compareBoundaryPoints",
    "Range.prototype.cloneContents",
    "Range.prototype.toString",
    "Range.prototype.createContextualFragment",
    "Range.prototype.selectNode",
    "Range.prototype.collapse",
    "Range.prototype.setEndBefore",
    "Range.prototype.detach",
    "Range.prototype.setStart",
    "Range.prototype.comparePoint",
    "Range.prototype.selectNodeContents",
    "Range.prototype.cloneRange",
    "Range.prototype.setEndAfter",
    "Range.prototype.surroundContents",
    "RangeException",
    "RangeException.toString",
    "RangeException.prototype.toString",
    "Text.toString",
    "Text.prototype.splitText",
    "Text.prototype.replaceWholeText",
    "TextMetrics.toString",
    "UIEvent.toString",
    "UIEvent.prototype.initUIEvent",
    "Window.toString",
    "Window.prototype.releaseEvents",
    "Window.prototype.scrollBy",
    "Window.prototype.alert",
    "Window.prototype.removeEventListener",
    "Window.prototype.btoa",
    "Window.prototype.postMessage",
    "Window.prototype.webkitRequestFileSystem",
    "Window.prototype.open",
    "Window.prototype.focus",
    "Window.prototype.prompt",
    "Window.prototype.getMatchedCSSRules",
    "Window.prototype.webkitCancelAnimationFrame",
    "Window.prototype.webkitConvertPointFromPageToNode",
    "Window.prototype.webkitPostMessage",
    "Window.prototype.find",
    "Window.prototype.scroll",
    "Window.prototype.getSelection",
    "Window.prototype.print",
    "Window.prototype.setInterval",
    "Window.prototype.close",
    "Window.prototype.stop",
    "Window.prototype.dispatchEvent",
    "Window.prototype.resizeBy",
    "Window.prototype.clearTimeout",
    "Window.prototype.setTimeout",
    "Window.prototype.clearInterval",
    "Window.prototype.captureEvents",
    "Window.prototype.toString",
    "Window.prototype.webkitConvertPointFromNodeToPage",
    "Window.prototype.webkitCancelRequestAnimationFrame",
    "Window.prototype.atob",
    "Window.prototype.moveTo",
    "Window.prototype.webkitResolveLocalFileSystemURL",
    "Window.prototype.getComputedStyle",
    "Window.prototype.confirm",
    "Window.prototype.scrollTo",
    "Window.prototype.webkitRequestAnimationFrame",
    "Window.prototype.matchMedia",
    "Window.prototype.resizeTo",
    "Window.prototype.blur",
    "Window.prototype.showModalDialog",
    "Window.prototype.moveBy",
    "Window.prototype.openDatabase",
    "Window.prototype.addEventListener",
    "XMLHttpRequest.toString",
    "XMLHttpRequest.prototype.getResponseHeader",
    "XMLHttpRequest.prototype.removeEventListener",
    "XMLHttpRequest.prototype.open",
    "XMLHttpRequest.prototype.abort",
    "XMLHttpRequest.prototype.setRequestHeader",
    "XMLHttpRequest.prototype.send",
    "XMLHttpRequest.prototype.dispatchEvent",
    "XMLHttpRequest.prototype.overrideMimeType",
    "XMLHttpRequest.prototype.getAllResponseHeaders",
    "XMLHttpRequest.prototype.addEventListener",
    "XMLSerializer.toString",
    "XMLSerializer.prototype.serializeToString",
    "XPathResult.toString",
    "XPathResult.prototype.iterateNext",
    "XPathResult.prototype.snapshotItem",
    "XSLTProcessor.toString",
    "XSLTProcessor.prototype.removeParameter",
    "XSLTProcessor.prototype.reset",
    "XSLTProcessor.prototype.clearParameters",
    "XSLTProcessor.prototype.transformToFragment",
    "XSLTProcessor.prototype.setParameter",
    "XSLTProcessor.prototype.importStylesheet",
    "XSLTProcessor.prototype.transformToDocument",
    "XSLTProcessor.prototype.getParameter",
    "ArrayBuffer.toString",
    "ArrayBuffer.prototype.slice",
    "DataView.toString",
    "DataView.prototype.getUint16",
    "DataView.prototype.setFloat32",
    "DataView.prototype.setInt16",
    "DataView.prototype.getInt16",
    "DataView.prototype.getInt8",
    "DataView.prototype.getFloat32",
    "DataView.prototype.setUint8",
    "DataView.prototype.setInt8",
    "DataView.prototype.getUint8",
    "DataView.prototype.setFloat64",
    "DataView.prototype.getFloat64",
    "DataView.prototype.getUint32",
    "DataView.prototype.getInt32",
    "DataView.prototype.setInt32",
    "DataView.prototype.setUint16",
    "DataView.prototype.setUint32",
    "Float32Array.toString",
    "Float32Array.prototype.set",
    "Float32Array.prototype.subarray",
    "Float64Array.toString",
    "Float64Array.prototype.set",
    "Float64Array.prototype.subarray",
    "Int16Array.toString",
    "Int16Array.prototype.set",
    "Int16Array.prototype.subarray",
    "Int32Array.toString",
    "Int32Array.prototype.set",
    "Int32Array.prototype.subarray",
    "Int8Array.toString",
    "Int8Array.prototype.set",
    "Int8Array.prototype.subarray",
    "Uint16Array.toString",
    "Uint16Array.prototype.set",
    "Uint16Array.prototype.subarray",
    "Uint32Array.toString",
    "Uint32Array.prototype.set",
    "Uint32Array.prototype.subarray",
    "Uint8Array.toString",
    "Uint8Array.prototype.set",
    "Uint8Array.prototype.subarray",
    "console.log",
    "console.warn",
    "console.error",
    "Node.prototype.attachEvent",
    "Node.prototype.detachEvent",
    "Node.prototype.doScroll"
];

/** Create builtin models for all the builtins above, and attach them to the objects. */
exports.tagBuiltins = function(global) {
	builtins.forEach(function(full_name) {
		var components = full_name.split('.'), obj = global, name = "";
		for(var i=0;i<components.length;++i) {
			var old_obj = obj;
			obj = obj[components[i]];
			name = name + (i ? "." : "") + components[i];
			if(!obj) {
				return;
			} else if(!obj.hasOwnProperty('__tag')) {
				var tag = new Tag({ type: 'builtin', name: name });
			
				// the model for X.prototype keeps a reference to the model of X; this is so we
				// recognise, say, Object.prototype when we see it
				if(components[i] === 'prototype') {
					tag.default_proto_of = old_obj.__tag;
				}
			
				util.setHiddenProp(obj, '__tag', tag);
			}
		}
	});
};